<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="LiWuK0jxrq55oR5-aNOK6r0wFuUC8EvSlpNYhiiBkDk">
  <meta name="baidu-site-verification" content="code-MRwc3a52M3">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhengjun.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
<meta property="og:type" content="website">
<meta property="og:title" content="郑君的学习笔记">
<meta property="og:url" content="http://zhengjun.top/page/13/index.html">
<meta property="og:site_name" content="郑君的学习笔记">
<meta property="og:description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="郑  君">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://zhengjun.top/page/13/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/13/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>郑君的学习笔记</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="郑君的学习笔记" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">郑君的学习笔记</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">要比昨天进步一点点</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">213</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">79</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">1251</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="郑  君"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">郑  君</p>
  <div class="site-description" itemprop="description">C++，golang，Java，Python，Kotlin，区块链，全栈</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">1251</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">79</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">213</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ZhengHanYunBlog" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ZhengHanYunBlog" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhenghanyun2021@126.com" title="E-Mail → mailto:zhenghanyun2021@126.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCmh8TlSil0IrCA-AQ9Xx9_Q" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCmh8TlSil0IrCA-AQ9Xx9_Q" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/25/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-tcp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/25/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-tcp/" class="post-title-link" itemprop="url">csharp-tcp</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-07-25 13:06:36 / 修改时间：13:07:21" itemprop="dateCreated datePublished" datetime="2020-07-25T13:06:36+08:00">2020-07-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>835</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private TcpClient client = new TcpClient();</span><br><span class="line">public MainWindow()</span><br><span class="line">&#123;</span><br><span class="line">    InitializeComponent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void btn_client_start_Click(object sender, RoutedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    // tcp client demo</span><br><span class="line">    var hostname = &quot;localhost&quot;;</span><br><span class="line">    try</span><br><span class="line">    &#123;</span><br><span class="line">        client.Connect(hostname, 8000);</span><br><span class="line">    &#125;catch(Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show($&quot;connect failed. msg=&#123;ex.Message&#125;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    using NetworkStream networkStream = client.GetStream();</span><br><span class="line">    networkStream.ReadTimeout = 2000;</span><br><span class="line"></span><br><span class="line">    using var writer = new StreamWriter(networkStream);</span><br><span class="line"></span><br><span class="line">    var message = &quot;HEAD / HTTP/1.1\r\nHost: webcode.me\r\nUser-Agent: C# program\r\n&quot;</span><br><span class="line">        + &quot;Connection: close\r\nAccept: text/html\r\n\r\n&quot;;</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(message);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    byte[] bytes = Encoding.UTF8.GetBytes(message);</span><br><span class="line">    networkStream.Write(bytes, 0, bytes.Length);</span><br><span class="line"></span><br><span class="line">    using var reader = new StreamReader(networkStream, Encoding.UTF8);</span><br><span class="line">    string resp = reader.ReadToEnd();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/25/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%9F%E6%B4%BB%E5%B0%8F%E7%9F%A5%E8%AF%86/%E6%B0%B4%E8%B4%A8%E6%A3%80%E6%B5%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/25/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%9F%E6%B4%BB%E5%B0%8F%E7%9F%A5%E8%AF%86/%E6%B0%B4%E8%B4%A8%E6%A3%80%E6%B5%8B/" class="post-title-link" itemprop="url">水质检测</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-07-25 08:47:47 / 修改时间：08:48:37" itemprop="dateCreated datePublished" datetime="2020-07-25T08:47:47+08:00">2020-07-25</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/24/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%9F%E6%B4%BB%E5%B0%8F%E7%9F%A5%E8%AF%86/%E9%AB%98%E5%B1%82%E5%A6%82%E4%BD%95%E9%80%89%E6%A5%BC%E5%B1%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/24/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%9F%E6%B4%BB%E5%B0%8F%E7%9F%A5%E8%AF%86/%E9%AB%98%E5%B1%82%E5%A6%82%E4%BD%95%E9%80%89%E6%A5%BC%E5%B1%82/" class="post-title-link" itemprop="url">高层如何选楼层</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-24 16:36:40" itemprop="dateCreated datePublished" datetime="2020-07-24T16:36:40+08:00">2020-07-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-07-25 11:23:44" itemprop="dateModified" datetime="2020-07-25T11:23:44+08:00">2020-07-25</time>
      </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <img alt="20200724_163721.png" src="/2020/07/24/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%9F%E6%B4%BB%E5%B0%8F%E7%9F%A5%E8%AF%86/%E9%AB%98%E5%B1%82%E5%A6%82%E4%BD%95%E9%80%89%E6%A5%BC%E5%B1%82/20200724_163721.png" width="500" height>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/23/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6-%E6%96%87%E4%BB%B6%E5%A4%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/23/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6-%E6%96%87%E4%BB%B6%E5%A4%B9/" class="post-title-link" itemprop="url">wpf-选择文件,文件夹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-23 13:48:39" itemprop="dateCreated datePublished" datetime="2020-07-23T13:48:39+08:00">2020-07-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-03-30 10:16:32" itemprop="dateModified" datetime="2021-03-30T10:16:32+08:00">2021-03-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="选择文件"><a href="#选择文件" class="headerlink" title="选择文件"></a>选择文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;TextBlock VerticalAlignment=&quot;Center&quot; Margin=&quot;4,0&quot;&gt;测量项监控目录：&lt;/TextBlock&gt;</span><br><span class="line">&lt;TextBox x:Name=&quot;tb_monitor_path&quot; Width=&quot;500&quot; VerticalAlignment=&quot;Center&quot; Text=&quot;&#123;Binding Path=MonitorPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged&#125;&quot;&gt;&lt;/TextBox&gt;</span><br><span class="line">&lt;Button x:Name=&quot;btn_browse&quot; VerticalAlignment=&quot;Center&quot; Margin=&quot;4,0&quot; Click=&quot;btn_browse_Click&quot;&gt;浏    览&lt;/Button&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var openFileDialog = new Microsoft.Win32.OpenFileDialog()</span><br><span class="line">&#123;</span><br><span class="line">    Filter = &quot;Excel Files (*.sql)|*.sql|All files (*.*)|*.*&quot;</span><br><span class="line">&#125;;</span><br><span class="line">var result = openFileDialog.ShowDialog();</span><br><span class="line">if (result == true)</span><br><span class="line">&#123;</span><br><span class="line">    this.textblock_filename.Text = openFileDialog.FileName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="选择文件夹"><a href="#选择文件夹" class="headerlink" title="选择文件夹"></a>选择文件夹</h2><h3 id="net-core"><a href="#net-core" class="headerlink" title=".net core"></a>.net core</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 项目名称上 右键菜单- Edit project file</span><br><span class="line">// 项目里面添加  &lt;UseWindowsForms&gt;true&lt;/UseWindowsForms&gt;</span><br><span class="line">&lt;PropertyGroup&gt;</span><br><span class="line">    &lt;OutputType&gt;WinExe&lt;/OutputType&gt;</span><br><span class="line">    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;</span><br><span class="line">    &lt;UseWPF&gt;true&lt;/UseWPF&gt;</span><br><span class="line">    &lt;UseWindowsForms&gt;true&lt;/UseWindowsForms&gt;</span><br><span class="line">&lt;/PropertyGroup&gt;</span><br><span class="line"></span><br><span class="line">// 代码如下</span><br><span class="line">private void btn_monitor_browse_Click(object sender, RoutedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    System.Windows.Forms.FolderBrowserDialog fbd = new System.Windows.Forms.FolderBrowserDialog();</span><br><span class="line">    System.Windows.Forms.DialogResult result = fbd.ShowDialog();</span><br><span class="line"></span><br><span class="line">    if (result == System.Windows.Forms.DialogResult.Cancel)</span><br><span class="line">    &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    tb_monitor_path.Text = fbd.SelectedPath.Trim();</span><br><span class="line">    App.db.Update_model&lt;Model_config&gt;(App.db.m_config[0]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="net-framework"><a href="#net-framework" class="headerlink" title=".net framework"></a>.net framework</h3><p>项目右键 add reference- Assemblies -System.Windows.Forms</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/22/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E6%B3%A2%E5%9E%8B%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/22/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E6%B3%A2%E5%9E%8B%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">wpf-波型数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-07-22 11:09:57 / 修改时间：11:16:06" itemprop="dateCreated datePublished" datetime="2020-07-22T11:09:57+08:00">2020-07-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>196</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="正弦波"><a href="#正弦波" class="headerlink" title="正弦波"></a>正弦波</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 正弦波</span><br><span class="line">// 周期</span><br><span class="line">var cycle = 8;</span><br><span class="line">// 幅度</span><br><span class="line">var magnitude = 100;</span><br><span class="line">for (double x = 1.0; x &lt; 100.0; ++x)</span><br><span class="line">&#123;</span><br><span class="line">    double y = Math.Sin(x / 180 * Math.PI * cycle) * magnitude;</span><br><span class="line">    list_x.Add(x);</span><br><span class="line">    list_y.Add(y);</span><br><span class="line">&#125;</span><br><span class="line">//  chart.Add(ref list_x, ref list_y);</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/18/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E5%8D%95%E5%AE%9E%E4%BE%8B%E8%BF%90%E8%A1%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/18/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-%E5%8D%95%E5%AE%9E%E4%BE%8B%E8%BF%90%E8%A1%8C/" class="post-title-link" itemprop="url">wpf-单实例运行</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-18 17:19:24" itemprop="dateCreated datePublished" datetime="2020-07-18T17:19:24+08:00">2020-07-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-07-20 11:21:27" itemprop="dateModified" datetime="2020-07-20T11:21:27+08:00">2020-07-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>893</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Mutex mutex = null;</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;, EntryPoint = &quot;FindWindow&quot;)]</span><br><span class="line">private static extern IntPtr FindWindow(string sClass, string sWindow);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;)]</span><br><span class="line">public static extern bool SetForegroundWindow(IntPtr hWnd);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;)]</span><br><span class="line">public static extern void SwitchToThisWindow(IntPtr hWnd, bool fAltTab);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;, SetLastError = true)]</span><br><span class="line">static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);</span><br><span class="line"></span><br><span class="line">const int SW_HIDE = 0;</span><br><span class="line">const int SW_SHOWNORMAL = 1;</span><br><span class="line">const int SW_RESTORE = 9;</span><br><span class="line">const int SW_SHOW = 5;</span><br><span class="line"></span><br><span class="line">private void Application_Startup(object sender, StartupEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    bool createdNew = false;</span><br><span class="line">    mutex = new Mutex(true, &quot;SPCAssist&quot;, out createdNew);</span><br><span class="line">    if (!createdNew)</span><br><span class="line">    &#123;</span><br><span class="line">        IntPtr hWndPtr = FindWindow(null, &quot;SPCAssist&quot;);</span><br><span class="line">        //移动到最前</span><br><span class="line">        SwitchToThisWindow(hWndPtr, true);</span><br><span class="line">        //s2;显示窗体</span><br><span class="line">        ShowWindow(hWndPtr, SW_SHOW| SW_RESTORE);</span><br><span class="line">        //s3: 置顶</span><br><span class="line">        SetForegroundWindow(hWndPtr);</span><br><span class="line">        Shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/18/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-broadcast-message/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/18/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-broadcast-message/" class="post-title-link" itemprop="url">csharp-broadcast message</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-07-18 13:43:03 / 修改时间：13:45:03" itemprop="dateCreated datePublished" datetime="2020-07-18T13:43:03+08:00">2020-07-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[DllImport(&quot;user32.dll&quot;, SetLastError = true)]</span><br><span class="line">static extern bool PostMessage(IntPtr hWnd, uint Msg, </span><br><span class="line">              IntPtr wParam, IntPtr lParam);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;)]</span><br><span class="line">static extern bool PostThreadMessage(uint idThread, uint Msg, </span><br><span class="line">              UIntPtr wParam, IntPtr lParam);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;, SetLastError=true, CharSet=CharSet.Auto)]</span><br><span class="line">static extern bool SendMessageCallback(IntPtr hWnd, uint Msg, </span><br><span class="line">              UIntPtr wParam, IntPtr lParam, </span><br><span class="line">              SendMessageDelegate lpCallBack, UIntPtr dwData);</span><br><span class="line"></span><br><span class="line">[DllImport(&quot;user32.dll&quot;, SetLastError=true, CharSet=CharSet.Auto)]</span><br><span class="line">static extern bool SendNotifyMessage(IntPtr hWnd, uint Msg, </span><br><span class="line">              UIntPtr wParam, IntPtr lParam);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SendMessage() – Sends the specified message to a window or windows, calls the window procedure for the specified window and does not return until the window procedure has processed the message.</span><br><span class="line">PostMessage() – Posts a message in the message queue associated with the thread that created the specified window and returns without waiting for the thread to process the message.</span><br><span class="line">PostThreadMessage() – Posts a message to the message queue of the specified thread. It returns without waiting for the thread to process the message.</span><br><span class="line">SendNotifyMessage() – Sends the specified message to a window or windows. If the window was created by the calling thread, SendNotifyMessage calls the window procedure for the window and does not return until the window procedure has processed the message. If the window was created by a different thread, SendNotifyMessage passes the message to the window procedure and returns immediately; it does not wait for the window procedure to finish processing the message.</span><br><span class="line">SendMessageCallback() – Calls the window procedure for the specified window and returns immediately. After the window procedure processes the message, the system calls the specified callback function, passing the result of the message processing and an application-defined value to the callback function.</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/17/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-button/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/17/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/wpf/wpf-button/" class="post-title-link" itemprop="url">wpf-button</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-17 14:20:31" itemprop="dateCreated datePublished" datetime="2020-07-17T14:20:31+08:00">2020-07-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-01 14:38:30" itemprop="dateModified" datetime="2021-05-01T14:38:30+08:00">2021-05-01</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>449</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>按钮控件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Button Content=&quot;浏    览&quot; Name=&quot;btnBrowse&quot; Margin=&quot;4,0&quot; VerticalAlignment=&quot;Center&quot; Width=&quot;80&quot;  Background=&quot;#6699CC&quot; Click=&quot;btnBrowse_Click&quot;/&gt;</span><br></pre></td></tr></table></figure>

<h2 id="默认按钮"><a href="#默认按钮" class="headerlink" title="默认按钮"></a>默认按钮</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Button x:Name=&quot;btn_login&quot; Width=&quot;75&quot; Height=&quot;25&quot; Click=&quot;btn_login_Click&quot; IsDefault=&quot;True&quot;&gt;登    录&lt;/Button&gt;</span><br></pre></td></tr></table></figure>

<h2 id="按下，抬起事件"><a href="#按下，抬起事件" class="headerlink" title="按下，抬起事件"></a>按下，抬起事件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PreviewMouseUp</span><br><span class="line">PreviewMouseDown</span><br></pre></td></tr></table></figure>

<h2 id="背景色"><a href="#背景色" class="headerlink" title="背景色"></a>背景色</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m_cur_button.Background = Brushes.Gold;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/15/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-access-database/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/15/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-access-database/" class="post-title-link" itemprop="url">csharp-access database</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-15 17:36:04" itemprop="dateCreated datePublished" datetime="2020-07-15T17:36:04+08:00">2020-07-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-11-03 15:57:22" itemprop="dateModified" datetime="2020-11-03T15:57:22+08:00">2020-11-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>While we can use OLE DB if we’re using the .NET Framework, Microsoft has stated that OLE DB won’t be supported for .NET Core.</p>
<h2 id="net-core"><a href="#net-core" class="headerlink" title=".net core"></a>.net core</h2><p>使用 ODBC 来实现。</p>
<h2 id="net-framework"><a href="#net-framework" class="headerlink" title=".net framework"></a>.net framework</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Data;</span><br><span class="line">using System.Data.OleDb;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line">namespace SPCAssist</span><br><span class="line">&#123;</span><br><span class="line">    /*</span><br><span class="line">     * Oledb.4.0在64位系统上不支持，需要使用 x86 目标平台</span><br><span class="line">     */</span><br><span class="line">    public class AccessHelper</span><br><span class="line">    &#123;</span><br><span class="line">        OleDbConnection conn;</span><br><span class="line">        DataTable dt;</span><br><span class="line"></span><br><span class="line">        /*</span><br><span class="line">         * dbPath 完整路径 d:/ddd/dd.mdb</span><br><span class="line">         */</span><br><span class="line">        public int Open(string dbPath)</span><br><span class="line">        &#123;</span><br><span class="line">            if (conn==null)</span><br><span class="line">            &#123;</span><br><span class="line">                conn = new OleDbConnection();</span><br><span class="line">            &#125;</span><br><span class="line">            conn.ConnectionString = &quot;Provider=Microsoft.Jet.Oledb.4.0; Data Source=&quot; + dbPath;</span><br><span class="line"></span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void Close()</span><br><span class="line">        &#123;</span><br><span class="line">            conn.Close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public DataTable Query(string sql)</span><br><span class="line">        &#123;</span><br><span class="line">            OleDbCommand cmd = new OleDbCommand();</span><br><span class="line">            if (conn.State != ConnectionState.Open)</span><br><span class="line">                conn.Open();</span><br><span class="line">            cmd.Connection = conn;</span><br><span class="line">            cmd.CommandText = sql;</span><br><span class="line">            OleDbDataAdapter da = new OleDbDataAdapter(cmd);</span><br><span class="line">            dt = new DataTable();</span><br><span class="line">            da.Fill(dt);</span><br><span class="line">            </span><br><span class="line">            return dt;</span><br><span class="line">        &#125;</span><br><span class="line">        public int Exec(string sql)</span><br><span class="line">        &#123;</span><br><span class="line">            OleDbCommand cmd = new OleDbCommand();</span><br><span class="line">            if (conn.State != ConnectionState.Open)</span><br><span class="line">                conn.Open();</span><br><span class="line">            cmd.Connection = conn;</span><br><span class="line">            cmd.CommandText = sql;</span><br><span class="line">            int iRet = cmd.ExecuteNonQuery();</span><br><span class="line"></span><br><span class="line">            return iRet;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="query"><a href="#query" class="headerlink" title="query"></a>query</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sql</span> <span class="operator">=</span> &quot;select * from tblCharacteristic&quot;;</span><br><span class="line">var dt <span class="operator">=</span> access.Query(<span class="keyword">sql</span>);</span><br><span class="line">foreach (DataRow <span class="type">row</span> <span class="keyword">in</span> dt.Rows)</span><br><span class="line">&#123;</span><br><span class="line">    var ss <span class="operator">=</span> <span class="type">row</span>[&quot;CharacteristicID&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string mdfFile <span class="operator">=</span> @&quot;csharpexamples.mdb&quot;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> (OleDbConnection connection <span class="operator">=</span> <span class="keyword">new</span> OleDbConnection(string.Format(&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&#123;0&#125;&quot;, mdfFile)))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (OleDbCommand selectCommand <span class="operator">=</span> <span class="keyword">new</span> OleDbCommand(&quot;SELECT TOP 10 * FROM TABLE1&quot;, connection))</span><br><span class="line">    &#123;</span><br><span class="line">        connection.Open();</span><br><span class="line"> </span><br><span class="line">        DataTable <span class="keyword">table</span> <span class="operator">=</span> <span class="keyword">new</span> DataTable();</span><br><span class="line">        OleDbDataAdapter adapter <span class="operator">=</span> <span class="keyword">new</span> OleDbDataAdapter();</span><br><span class="line">        adapter.SelectCommand <span class="operator">=</span> selectCommand;</span><br><span class="line">        adapter.Fill(<span class="keyword">table</span>);</span><br><span class="line"> </span><br><span class="line">        foreach (DataRow <span class="type">row</span> <span class="keyword">in</span> table.Rows)</span><br><span class="line">        &#123;</span><br><span class="line">            object nameValue <span class="operator">=</span> <span class="type">row</span>[&quot;NAME&quot;];</span><br><span class="line">            object surnameValue <span class="operator">=</span> <span class="type">row</span>[&quot;SURNAME&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">string mdfFile = @&quot;csharpexamples.mdb&quot;;</span><br><span class="line"> </span><br><span class="line">using (OleDbConnection connection = new OleDbConnection(string.Format(&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&#123;0&#125;&quot;, mdfFile)))</span><br><span class="line">&#123;</span><br><span class="line">    using (OleDbCommand insertCommand = new OleDbCommand(&quot;INSERT INTO TABLE1 ([NAME],[SURNAME]) VALUES (?,?)&quot;, connection))</span><br><span class="line">    &#123;</span><br><span class="line">        connection.Open();</span><br><span class="line"> </span><br><span class="line">        insertCommand.Parameters.AddWithValue(&quot;@NAME&quot;, &quot;Brad&quot;);</span><br><span class="line">        insertCommand.Parameters.AddWithValue(&quot;@SURNAME&quot;, &quot;Pitt&quot;);</span><br><span class="line"> </span><br><span class="line">        insertCommand.ExecuteNonQuery();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">string mdfFile = @&quot;csharpexamples.mdb&quot;;</span><br><span class="line"> </span><br><span class="line">using (OleDbConnection connection = new OleDbConnection(string.Format(&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&#123;0&#125;&quot;, mdfFile)))</span><br><span class="line">&#123;</span><br><span class="line">    using (OleDbCommand updateCommand = new OleDbCommand(&quot;UPDATE TABLE1 SET [NAME] = ?, [SURNAME] = ? WHERE [ID] = ?&quot;, connection))</span><br><span class="line">    &#123;</span><br><span class="line">        connection.Open();</span><br><span class="line"> </span><br><span class="line">        updateCommand.Parameters.AddWithValue(&quot;@NAME&quot;, &quot;Brad2&quot;);</span><br><span class="line">        updateCommand.Parameters.AddWithValue(&quot;@SURNAME&quot;, &quot;Pitt2&quot;);</span><br><span class="line">        updateCommand.Parameters.AddWithValue(&quot;@ID&quot;, 2);</span><br><span class="line"> </span><br><span class="line">        updateCommand.ExecuteNonQuery();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;      </span><br></pre></td></tr></table></figure>

<h2 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">string mdfFile = @&quot;csharpexamples.mdb&quot;;</span><br><span class="line"> </span><br><span class="line">using (OleDbConnection connection = new OleDbConnection(string.Format(&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&#123;0&#125;&quot;, mdfFile)))</span><br><span class="line">&#123;</span><br><span class="line">    using (OleDbCommand deleteCommand = new OleDbCommand(&quot;DELETE FROM TABLE1 WHERE [ID] = ?&quot;, connection))</span><br><span class="line">    &#123;</span><br><span class="line">        connection.Open();</span><br><span class="line"> </span><br><span class="line">        deleteCommand.Parameters.AddWithValue(&quot;@ID&quot;, 2);</span><br><span class="line"> </span><br><span class="line">        deleteCommand.ExecuteNonQuery();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhengjun.top/2020/07/14/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-dictionary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="郑  君">
      <meta itemprop="description" content="C++，golang，Java，Python，Kotlin，区块链，全栈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郑君的学习笔记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/14/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/csharp/csharp-dictionary/" class="post-title-link" itemprop="url">csharp-dictionary</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-14 09:30:55" itemprop="dateCreated datePublished" datetime="2020-07-14T09:30:55+08:00">2020-07-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-12-17 17:29:07" itemprop="dateModified" datetime="2020-12-17T17:29:07+08:00">2020-12-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Language/" itemprop="url" rel="index"><span itemprop="name">Language</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>442</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="初始化，遍历"><a href="#初始化，遍历" class="headerlink" title="初始化，遍历"></a>初始化，遍历</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dictionary&lt;int, string&gt; dict = new Dictionary&lt;int, string&gt;()</span><br><span class="line">                                            &#123;</span><br><span class="line">                                                &#123;1,&quot;One&quot;&#125;,</span><br><span class="line">                                                &#123;2, &quot;Two&quot;&#125;,</span><br><span class="line">                                                &#123;3,&quot;Three&quot;&#125;</span><br><span class="line">                                            &#125;;</span><br><span class="line"></span><br><span class="line">foreach (KeyValuePair&lt;int, string&gt; item in dict)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(&quot;Key: &#123;0&#125;, Value: &#123;1&#125;&quot;, item.Key, item.Value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach (var it in nominalVals.Values)</span><br><span class="line">&#123;</span><br><span class="line">    sData[pos] = *((int*)&amp;it);</span><br><span class="line">    pos += 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>如果是结构体的话<br>不能直接使用 x[‘x’] = xx 的方式更新，好奇怪。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/126/">126</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">郑  君</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">2m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">30:32</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/code-unfold.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <script type="text/javascript" src="/js/fold_action.js"></script>

</body>
</html>
